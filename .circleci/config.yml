version: 2.1
jobs:
  build:
    docker: 
      - image: alpine
    environment: 
      aws-access-key-id: AKIAJC7WTJKFJXGMX7AQ
      aws-default-region: ap-south-1
      aws-secret-key-id: eH2T9Ya9SdFlx2+WVMCQTi6upFixMF1h4/dx/l+3
    steps:
      - run: apk update && apk add git
      - run: apk add --update python python-dev py-pip build-base
      - run: pip install awscli 
      - run: echo $AWS_ACCESS_KEY_ID
      - run: echo $AWS_DEFAULT_REGION
      - run: echo $AWS_SECRET_ACCESS_KEY
workflows:
  deploy_application:
    jobs:
      - aws-code-deploy/deploy:
          application-name: MyReactApp
          deployment-group: MyReactApp-DG
          service-role-arn: aws:iam::760603953831:role/CodeDeployServiceRole2
          bundle-bucket: codefrontbucket
          bundle-key: ReactApp
orbs:
  aws-code-deploy: circleci/aws-code-deploy@0.0.11
